For extraction

Prior to running the extraction pipeline, fastx-toolkit, seqkit(Shen, W., Le, S., Li, Y., and Hu, F. (2016). SeqKit: A Cross-Platform and Ultrafast Toolkit for FASTA/Q File Manipulation. PLoS One 11, e0163962. 10.1371/journal.pone.0163962), Cutadapt (DOI: 10.14806/ej.17.1.200), and Bartender (Zhao, L., Liu, Z., Levy, S.F., and Wu, S. (2018). Bartender: a fast and accurate clustering algorithm to count barcode reads. Bioinformatics 34, 739-747. 10.1093/bioinformatics/btx655) must be installed.

The following code corresponds to the FASTQ files generated by PCR amplification of CPtracer sequences and subsequent single-end 300 bp sequencing. Please change the working directory to the folder containing your FASTQ files before running the code. In addition, replace the "pre-fix" file name with the file name of your own data.By executing CPtracer-extraction-1, CPtracer-extraction-2, and CPtracer-extraction-3 sequentially, all data will be integrated, and a consolidated csv file will be generated.



For tree reconstruction

Prior to running the tree reconstruction pipeline, pairwise2 (Cock, P.J., Antao, T., Chang, J.T., Chapman, B.A., Cox, C.J., Dalke, A., Friedberg, I., Hamelryck, T., Kauff, F., Wilczynski, B., and de Hoon, M.J. (2009). Biopython: freely available Python tools for computational molecular biology and bioinformatics. Bioinformatics 25, 1422-1423. 10.1093/bioinformatics/btp163), must be installed.

In the extracted sequences, the first 21 bp correspond to the random DNA barcode, while the sequence from the 22nd base onward corresponds to the scratchpad. After filtering, only these sequences are used as input for Alleles.txt. By executing Alleleanalysis.phy, a unique mutation list is generated, along with an Excel file summarizing which mutations are present in each allele. 

Based on the generated Excel file, three additional files should be prepared: alldata.txt and input.txt.

By executing Count.phy, an Excel file is generated that records, for each clone, the number of alleles carrying each mutation. The total number of alleles harboring a given mutation should be used as the FM value when preparing mutation.txt.

Subsequently, by executing Tree.phy, Poly.phy, and Conbine.phy, tree reconstruction is performed and the parameters associated with each branch are generated.

Sample input files illustrating the required format can be downloaded from this page.


